{% extends 'layouts/app.html' %} {% block css %}
<style></style>
{% endblock %} {% block content %}
<div class="row mt-3">
  <div class="col-12">{% include 'parcials/navbar.html' %}</div>
</div>
<div class="container">
  <div class="row">
    <div class="col-12 p-0">
      <div class="card rounded-0">
        <div class="card-body rounded-0">
          <h2>Baja de servicios</h2>
          <div class="row">
            <div class="col-12">
              <table class="table">
                <tbody>
                  <tr>
                    <td>
                      <strong
                        >Servicio de Streaming de Películas y Series - CinePlus
                        HD</strong
                      >
                      <ul>
                        <li>
                          Descripción: Acceso ilimitado a una amplía selección
                          de peliculas y series en alta definición, incluyendo
                          estrenos y clásicos.
                        </li>
                        <li>Precio Mensual: $12</li>
                      </ul>
                    </td>
                    <td>
                      <input
                        class="inputCheckBoxs"
                        type="checkbox"
                        name="cineplus"
                      />
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <strong
                        >Suscripción de Juegos en la Nube - CloudGames
                        Pro</strong
                      >
                      <ul>
                        <li>
                          Descripción: Acceso ilimitado a una biblioteca de
                          videjuegos de alta calidad, sin necesidad de consola o
                          hardware especializado.
                        </li>
                        <li>Precio Mensual: $20</li>
                      </ul>
                    </td>
                    <td>
                      <input
                        class="inputCheckBoxs"
                        type="checkbox"
                        name="cloudgames"
                      />
                    </td>
                  </tr>

                  <tr>
                    <td>
                      <strong
                        >Servicio de Streaming de Música - SoundPlus</strong
                      >
                      <ul>
                        <li>
                          Descripción: Acceso ilimitado a una biblioteca de más
                          de 50 millones de canciones y playlists
                          personalizados.
                        </li>
                        <li>Precio Mensual: $8</li>
                      </ul>
                    </td>
                    <td>
                      <input
                        class="inputCheckBoxs"
                        type="checkbox"
                        name="soundplus"
                      />
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <strong
                        >Plataforma de eBooks y AudioLibros - LibrosGo</strong
                      >
                      <ul>
                        <li>
                          Descripción: Acceso ilimitado a una vasta colección de
                          eBooks y audiolibros en diversos géneros literarios.
                        </li>
                        <li>Precio Mensual: $8</li>
                      </ul>
                    </td>
                    <td>
                      <input
                        class="inputCheckBoxs"
                        type="checkbox"
                        name="librosgo"
                      />
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="col-12 d-flex justify-content-end">
              <button
                type="button"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#modal_det_servicio"
              >
                <i class="fa fa-check"></i> Confirmar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="modal_det_servicio">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-body">
        <div class="row">
          <div class="col-12">
            <h4 class="w-100 text-center">Detalles del servicio</h4>
          </div>
          <div class="col-12">
            <strong>Nombre del Servicio:</strong>
            <ul>
              <li>Servicio Seleccionado: CinePlus HD</li>
            </ul>
          </div>
          <div class="col-12">
            <strong>Descripción del Servicio:</strong>
            <ul>
              <li>Acceso ilimitado a películas y series en HD</li>
            </ul>
          </div>
          <div class="col-12">
            <strong>Detalles de la Transacción</strong>
            <ul>
              <li>Tipo de Transacción: Activación</li>
              <li>Precio Mensual: $12</li>
              <li>
                Condiciones: Sin permanencia mínima, hasta 3 dispositivos
                simultáneamente
              </li>
            </ul>
          </div>
          <div class="col-12">
            <strong>Impacto de la Baja:</strong>
            <ul>
              <li>
                Se perderá acceso al catálogo de contenido a partir de la fecha
                de cancelación
              </li>
              <li>
                No se realizarán más cobros a partir del próximo ciclon de
                facturación
              </li>
              <li>
                Descargas de contenido sin conexión dejarán de estar disponibles
              </li>
            </ul>
          </div>
          <div class="col-12">
            <strong>Resumen Financiero:</strong>
            <ul>
              <li>Costo Final Pendiente: $0 (si ya ha pagado el mes actual)</li>
              <li>
                Posible Penalización: No aplica (en caso de contrato sin
                permanencia)
              </li>
            </ul>
          </div>
          <div class="col-12">
            <strong>Advertencias (si aplica):</strong>
            <ul>
              <li>
                Si decides reactivar el servicio más adelante, los costos pueden
                varia según las promociones vigentes
              </li>
              <li>
                Algunos beneficios acumulados, como descuentos, no serán
                restaurados
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="modal-footer justify-content-between">
        <button
          type="button"
          class="btn btn-outline-secondary"
          data-bs-dismiss="modal"
        >
          Cancelar
        </button>
        <button
          type="button"
          id="confirmar"
          class="btn btn-success"
          data-bs-dismiss="modal"
        >
          Confirmar
        </button>
      </div>
    </div>
  </div>
</div>

{% endblock %} {% block scripts %}
<script>
  const servicios = {
    cineplus: {
      nombre: "CinePlus HD",
      descripcion: "Acceso ilimitado a películas y series en HD",
      precio: "$12",
      tipo: "Baja",
      condiciones:
        "Sin permanencia mínima, hasta 3 dispositivos simultáneamente",
      impacto: [
        "Se perderá acceso al catálogo de contenido a partir de la fecha de cancelación",
        "No se realizarán más cobros a partir del próximo ciclo de facturación",
        "Descargas de contenido sin conexión dejarán de estar disponibles",
      ],
      resumen: [
        "Costo Final Pendiente: $0 (si ya ha pagado el mes actual)",
        "Posible Penalización: No aplica (en caso de contrato sin permanencia)",
      ],
      advertencias: [
        "Si decides reactivar el servicio más adelante, los costos pueden variar según las promociones vigentes",
        "Algunos beneficios acumulados, como descuentos, no serán restaurados",
      ],
    },
    cloudgames: {
      nombre: "CloudGames Pro",
      descripcion:
        "Acceso ilimitado a videojuegos sin necesidad de consola o hardware especializado",
      precio: "$20",
      tipo: "Baja",
      condiciones: "Acceso inmediato, sin restricciones",
      impacto: [
        "Perderás acceso a todos los juegos al finalizar el ciclo actual",
        "Tu historial de juego no se guardará en caso de reactivación tardía",
      ],
      resumen: ["Costo Final Pendiente: $0", "Penalización: No aplica"],
      advertencias: [
        "Puedes perder avances si reactivas más tarde",
        "Las promociones actuales pueden no estar disponibles en el futuro",
      ],
    },
    soundplus: {
      nombre: "SoundPlus",
      descripcion:
        "Acceso ilimitado a más de 50 millones de canciones y playlists personalizados",
      precio: "$8",
      tipo: "Baja",
      condiciones: "Uso ilimitado hasta el final del mes",
      impacto: [
        "Tus playlists dejarán de estar disponibles",
        "No se podrá escuchar música offline",
      ],
      resumen: ["Costo Final Pendiente: $0"],
      advertencias: ["La reactivación no recupera contenido personalizado"],
    },
    librosgo: {
      nombre: "LibrosGo",
      descripcion:
        "Acceso a una vasta colección de eBooks y audiolibros en todos los géneros",
      precio: "$8",
      tipo: "Baja",
      condiciones: "Sin compromiso",
      impacto: [
        "Los libros descargados ya no estarán accesibles",
        "Pérdida de marcadores y progreso de lectura",
      ],
      resumen: ["Costo Final Pendiente: $0"],
      advertencias: ["La cuenta volverá a estado gratuito si se reactiva"],
    },
  };

  document
    .querySelector('[data-bs-target="#modal_det_servicio"]')
    .addEventListener("click", () => {
      const seleccionados = Array.from(
        document.querySelectorAll(".inputCheckBoxs")
      )
        .filter((chk) => chk.checked)
        .map((chk) => chk.name);

      const modalBody = document.querySelector(
        "#modal_det_servicio .modal-body"
      );
      modalBody.innerHTML = `<h4 class="w-100 text-center">Detalles de la baja de servicios</h4>`;

      seleccionados.forEach((servicio) => {
        const s = servicios[servicio];
        modalBody.innerHTML += `
        <div class="mb-3">
          <strong>Nombre del Servicio:</strong>
          <ul><li>${s.nombre}</li></ul>

          <strong>Descripción:</strong>
          <ul><li>${s.descripcion}</li></ul>

          <strong>Tipo de Transacción:</strong>
          <ul><li>${s.tipo}</li></ul>

          <strong>Precio Mensual:</strong>
          <ul><li>${s.precio}</li></ul>

          <strong>Condiciones:</strong>
          <ul><li>${s.condiciones}</li></ul>

          <strong>Impacto de la Baja:</strong>
          <ul>${s.impacto.map((i) => `<li>${i}</li>`).join("")}</ul>

          <strong>Resumen Financiero:</strong>
          <ul>${s.resumen.map((i) => `<li>${i}</li>`).join("")}</ul>

          <strong>Advertencias:</strong>
          <ul>${s.advertencias.map((i) => `<li>${i}</li>`).join("")}</ul>
        </div>
      `;
      });
    });

  // Al confirmar, enviamos por fetch/POST la baja
  document.getElementById("confirmar").addEventListener("click", () => {
    const seleccionados = Array.from(
      document.querySelectorAll(".inputCheckBoxs")
    )
      .filter((chk) => chk.checked)
      .map((chk) => chk.name);

    fetch("/dar_baja_servicios", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": "{{ csrf_token }}",
      },
      body: JSON.stringify({ servicios: seleccionados }),
    })
      .then((res) => res.json())
      .then((data) => {
        alert("Servicios dados de baja correctamente.");
        location.reload();
      })
      .catch((err) => {
        console.error(err);
        alert("Hubo un error al dar de baja los servicios.");
      });
  });
</script>

{% endblock %}
